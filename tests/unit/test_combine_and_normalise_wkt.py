import shapely

from digital_land.datatype.wkt import WktDataType
from digital_land.phase.combine import combine_geometries

wkt_part_1 = """MultiPolygon (((-2.24601737358344744 51.86807939809743573, -2.2461832637820307 51.86811130238562839, -2.24634287142038458 51.86813633237564858, -2.24633546661849826 51.86815004139306495, -2.24631997927963489 51.8681810123477689, -2.24629075541133316 51.86824176375447593, -2.24586139886259772 51.86816114791497512, -2.24587849648024029 51.86812179390931021, -2.24573040845903549 51.8680971258538861, -2.245751293800752 51.86805188374731301, -2.24590131179755348 51.86807893039648576, -2.24590849263859571 51.86805875724090953, -2.2459627604587582 51.86806804855640962, -2.24601737358344744 51.86807939809743573)))"""  # noqa
wkt_part_2 = """MultiPolygon (((-2.24629398711633055 51.8682112320496671, -2.24630877690783226 51.86818018163847199, -2.24630978127519576 51.86817793174959235, -2.24631481048186155 51.86816803096150608, -2.24631911596334222 51.86815858124546708, -2.24632701794170409 51.86814283019816685, -2.24621799271166855 51.86812507608690481, -2.24617874217634972 51.86811841485085495, -2.24615184652430777 51.86811352598648739, -2.24613221758215342 51.86810952103083849, -2.24608641722161639 51.86810026603200896, -2.24595410980870236 51.8680743784229108, -2.2459548286269615 51.86807302824853139, -2.24595842517116351 51.86806672692875964, -2.24598009081509531 51.86807135703590887, -2.24602676695685588 51.8680814194479467, -2.24605584356776777 51.86808675333755048, -2.24607183668856658 51.86808986679464084, -2.24608710363246811 51.86809298176824257, -2.24616561446595631 51.86810810249696146, -2.24619541728982774 51.86811343483294934, -2.24621780424763129 51.8681171642727108, -2.24622739865924892 51.8681187626027409, -2.24631679245208282 51.86813206222821293, -2.24636607216546835 51.86814014100393422, -2.24639238396306906 51.86814449157325413, -2.24639125599387679 51.86815069782601739, -2.24639097584493497 51.86815258655332173, -2.24636204684573215 51.86814770199449498, -2.24633864173463138 51.86814370497918247, -2.24633145856850147 51.86815810585058983, -2.2463199650017418 51.86818105733338768, -2.24631795626779196 51.86818555711132461, -2.24630561584032229 51.8682130059382942, -2.24629398711633055 51.8682112320496671)))"""  # noqa


def test_combined_wkt_normalised():

    combined = combine_geometries([wkt_part_1, wkt_part_2])

    wkt = WktDataType()
    normalised = wkt.normalise(combined)

    combined_geometry = shapely.wkt.loads(normalised)

    assert combined_geometry.is_valid
